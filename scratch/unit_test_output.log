
******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit https://github.com/coin-or/Ipopt
******************************************************************************

[ Info: Auto-placed 2 interior knots for 1→2 transition at: [0.333, 0.667]
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [0.333, 0.667]

Phase-Type Correctness Tests Complete

Phase-Type Tests Complete
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [0.47, 0.609]
[ Info: Auto-placed 2 interior knots for 2→1 transition at: [0.36, 0.471]
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [0.47, 0.609]
[ Info: Auto-placed 2 interior knots for 2→1 transition at: [0.36, 0.471]
[ Info: Natural boundary conditions are not currently compatible with monotone splines. The restrictions on second derivatives at the spline boundaries will be removed.
[ Info: Natural boundary conditions are not currently compatible with monotone splines. The restrictions on second derivatives at the spline boundaries will be removed.
[ Info: Natural boundary conditions are not currently compatible with monotone splines. The restrictions on second derivatives at the spline boundaries will be removed.
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [1.168, 2.697]
[ Info: Auto-placed 2 interior knots for 1→3 transition at: [2.798, 3.578]
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [1.168, 2.697]
[ Info: Auto-placed 2 interior knots for 1→3 transition at: [2.798, 3.578]
[ Info: Using observed transition times for knot calibration
[ Info: Calibrated 2 interior knots for h12 at: [1.168, 2.697]
[ Info: Calibrated 2 interior knots for h13 at: [2.798, 3.578]
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [1.168, 2.697]
[ Info: Auto-placed 2 interior knots for 1→3 transition at: [2.798, 3.578]
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [1.168, 2.697]
[ Info: Auto-placed 2 interior knots for 1→3 transition at: [2.798, 3.578]
[ Info: Using observed transition times for knot calibration
[ Info: Calibrated 3 interior knots for h12 at: [0.877, 1.946, 2.929]
[ Info: Calibrated 3 interior knots for h13 at: [2.429, 3.301, 3.787]
[ Info: Using observed transition times for knot calibration
[ Info: Calibrated 4 interior knots for h12 at: [0.73, 1.294, 2.178, 3.219]
[ Info: Calibrated 2 interior knots for h13 at: [2.798, 3.578]
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [1.168, 2.697]
[ Info: Auto-placed 2 interior knots for 1→3 transition at: [2.798, 3.578]
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [1.168, 2.697]
[ Info: Auto-placed 2 interior knots for 1→3 transition at: [2.798, 3.578]
[ Info: Using observed transition times for knot calibration
[ Info: Calibrated 3 interior knots for h12 at: [0.877, 1.946, 2.929]
[ Info: Calibrated 3 interior knots for h13 at: [2.429, 3.301, 3.787]
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [1.168, 2.697]
[ Info: Auto-placed 2 interior knots for 1→3 transition at: [2.798, 3.578]
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [1.168, 2.697]
[ Info: Auto-placed 2 interior knots for 1→3 transition at: [2.798, 3.578]
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [1.168, 2.697]
[ Info: Auto-placed 2 interior knots for 1→3 transition at: [2.798, 3.578]
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [1.168, 2.697]
[ Info: Auto-placed 2 interior knots for 1→3 transition at: [2.798, 3.578]
[ Info: Using observed transition times for knot calibration
[ Info: Calibrated 4 interior knots for h12 at: [0.73, 1.294, 2.178, 3.219]
[ Info: Calibrated 4 interior knots for h13 at: [1.995, 2.838, 3.451, 4.286]
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [1.168, 2.697]
[ Info: Auto-placed 2 interior knots for 1→3 transition at: [2.798, 3.578]
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [1.168, 2.697]
[ Info: Auto-placed 2 interior knots for 1→3 transition at: [2.798, 3.578]
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [1.168, 2.697]
[ Info: Auto-placed 2 interior knots for 1→3 transition at: [2.798, 3.578]
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [1.168, 2.697]
[ Info: Auto-placed 2 interior knots for 1→3 transition at: [2.798, 3.578]
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [1.168, 2.697]
[ Info: Auto-placed 2 interior knots for 1→3 transition at: [2.798, 3.578]
[ Info: Auto-placed 2 interior knots for 1→2 transition at: [1.168, 2.697]
[ Info: Auto-placed 2 interior knots for 1→3 transition at: [2.798, 3.578]
Fitting Markov surrogate via MLE ...

Markov surrogate MLE complete.


  Sample-level MLL estimates:
    IS-weighted (full pool): -35.4531
    SIR (ESS=200):    -35.1639
    LHS (ESS=200):    -35.3625
    Max absolute difference: 0.2892

  Subject-level MLL agreement:
    Correlation (SIR vs IS):  0.9991
    Correlation (LHS vs IS):  0.9993
    Correlation (SIR vs LHS): 0.9988
    Relative MAE (SIR vs IS): 2.51%
    Relative MAE (LHS vs IS): 1.95%

  Runtime benchmarks (50 reps, warmed up):
    Pool size: 382 paths/subject avg, ESS target: 200

    MLL computation only (excluding resampling):
      IS-weighted (full pool, 382 paths): 0.0041 ms
      SIR resampled (200 paths):             0.0089 ms
      LHS resampled (200 paths):             0.0086 ms
      Speedup (IS/SIR): 0.47x
      Speedup (IS/LHS): 0.48x

    Resampling overhead:
      SIR resampling: 0.5648 ms
      LHS resampling: 0.399 ms

    Total (MLL + resampling):
      IS-weighted:    0.0041 ms
      SIR:            0.5737 ms
      LHS:            0.4076 ms

    Log-likelihood computation (M-step bottleneck, 10 reps):
      Full pool (19107 paths total): 52.47 ms
      SIR subset (10000 paths total):  23.02 ms
      LHS subset (10000 paths total):  20.12 ms
      Speedup (Full/SIR): 2.28x
      Speedup (Full/LHS): 2.61x
      Expected speedup (paths ratio): 1.91x

  Variance comparison (50 replications, ESS=200):
    Full Pool IS variance: 0.0 (deterministic)
    SIR variance:          0.0315, SD: 0.1774
    LHS variance:          0.0217, SD: 0.1472
    Variance ratio (SIR/LHS): 1.45

    Full Pool IS mean:     -35.4531 (exact)
    SIR mean:              -35.4592
    LHS mean:              -35.4281

    Variance computation runtimes:
      SIR (50 reps):  0.033 s
      LHS (50 reps):  0.022 s

  Unbiasedness check (100 bootstrap samples):
    IS estimate:   -35.4531
    SIR mean:      -35.4845, bias: -0.0315
    LHS mean:      -35.4786, bias: -0.0255
    SIR SD:        0.2727
    LHS SD:        0.2669

  Edge case tests passed

✓ All MLL consistency tests completed
[ Info: Constrained fit had numerical issues: MethodError
Parallel likelihood tests completed!
Julia threads available: 1
Physical cores detected: 10
Test Summary: | Pass  Total     Time
Unit Tests    | 1323   1323  3m19.5s
[ Info: Running quick tests only. Set MSM_TEST_LEVEL=full for complete suite.
